package com.bridgelabz.Fundoo.controller;

import javax.servlet.http.HttpServletRequest;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

import com.bridgelabz.Fundoo.dto.ForgetPasswordDto;
import com.bridgelabz.Fundoo.dto.LoginDto;
import com.bridgelabz.Fundoo.dto.RegisterDto;
import com.bridgelabz.Fundoo.dto.ResetPasswordDto;
import com.bridgelabz.Fundoo.dto.VerificationDto;
import com.bridgelabz.Fundoo.result.LoginRegistrationStatus;
import com.bridgelabz.Fundoo.services.ServiceImplementation;

@RestController
public class LoginRegistrationController {

	@Autowired
	private ServiceImplementation serviceImplementation;

	/***************** Registration Controller ******************/

	@RequestMapping(value = "/user/register", method = RequestMethod.POST)
	public LoginRegistrationStatus registerUser(@RequestBody RegisterDto register, HttpServletRequest request) {
		System.out.println("In Register User");
		LoginRegistrationStatus status = serviceImplementation.Registration(register, request);
		return status;
	}

	/************************ Login Controller *******************/

	@RequestMapping(value = "/user/login", method = RequestMethod.GET)
	public LoginRegistrationStatus loginUser(@RequestBody LoginDto login, HttpServletRequest request) {
		System.out.println("In Logging User");
		LoginRegistrationStatus loginstatus = serviceImplementation.Login(login, request);
		return loginstatus;
	}

	/*********************** Forget Password Controller *********************/

	@RequestMapping(value = "/user/forgotpassword", method = RequestMethod.POST)
	public LoginRegistrationStatus forgetPassword(@RequestBody ForgetPasswordDto forgetdto, HttpServletRequest request) {
		System.out.println("Forget Password");
		LoginRegistrationStatus status = serviceImplementation.forgetPassword(forgetdto, request);
		return status;
	}

	/********************** Reset Password Controller ***************************/

	@RequestMapping(value = "/user/resetpassword", method = RequestMethod.POST)
	public LoginRegistrationStatus resetPassword(@RequestBody ResetPasswordDto setpassword, HttpServletRequest request) {
		System.out.println("Reset Password");
		LoginRegistrationStatus status = serviceImplementation.resetPassword(setpassword, request);
		return status;
	}

	/***************************** Verify User *******************************/
	@RequestMapping(value = "/user/verify", method = RequestMethod.GET)
	public LoginRegistrationStatus validateUser(@RequestBody VerificationDto verificationdto, HttpServletRequest request) {
		LoginRegistrationStatus status = serviceImplementation.vlidateUser(verificationdto, request);
		return status;
	}

}
